#Program to train the model on entire dataset
import numpy as np
from sklearn.tree import DecisionTreeClassifier
import pickle

X = np.load('features.npy')         #loads the newfeatarray created by featextract.py
Y = np.zeros(10238)
for i in range(5125,10238):             #Set the label 0 for benign and 1 for malware
    Y[i]=1
    

clf = DecisionTreeClassifier()
clf.fit(X,Y)

filename = 'model.sav'
pickle.dump(clf, open(filename, 'wb'))          #Saves the trained model in model.csv file