import numpy as np
from sklearn.ensemble import RandomForestClassifier
import pickle

X = np.load('features.npy')             #loads the features  created by extract_features.py
Y = np.zeros(10238)
for i in range(5125,10238):             #Set the label 0 for benign and 1 for malware
    Y[i]=1


X_new = X[:,3:11]
X_new = np.append(X_new,X[:,12:13],axis = 1)
X_new = np.append(X_new,X[:,15:25],axis = 1)
X_new = np.append(X_new,X[:,0:1],axis =1)
X = X_new


clf = RandomForestClassifier(n_estimators = 100)        #Random Forest Classifier
clf.fit(X,Y)

filename = 'model.sav'              
pickle.dump(clf, open(filename, 'wb'))     